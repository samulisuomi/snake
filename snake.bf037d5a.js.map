{"version":3,"sources":["index.js"],"names":["field","width","length","height","direction","nextDirectionCandidate","headY","headX","tailY","tailX","gameOver","directionUpdatedThisTick","window","foo","nextHeadY","nextHeadX","moveSnake","endGame","onMouseDown","event","target","textContent","onNewDirection","onKeyDown","code","newDirection","setDirection","onTick","draw","console","log","containerElement","document","querySelector","forEach","row","rowElement","createElement","className","cell","cellElement","appendChild","addEventListener","_event","setInterval"],"mappings":"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","file":"snake.bf037d5a.js","sourceRoot":"..","sourcesContent":["this.field = [\r\n  [3,0,0,0,0,0,0,0,0,0],\r\n  [2,0,0,0,0,0,0,0,0,0],\r\n  [1,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n  [0,0,0,0,0,0,0,0,0,0],\r\n]\r\n\r\nthis.width = this.field[0].length\r\nthis.height = this.field.length\r\n\r\nthis.direction = 'r'\r\nthis.nextDirectionCandidate = null\r\nthis.length = 5\r\nthis.headY = 2\r\nthis.headX = 0\r\nthis.tailY = 0\r\nthis.tailX = 0\r\nthis.gameOver = false\r\nthis.directionUpdatedThisTick = false\r\n\r\nwindow.foo = this\r\n\r\nthis.nextHeadY = () => {\r\n  switch(this.direction) {\r\n    case 'u':\r\n      return this.headY - 1\r\n    case 'd':\r\n      return this.headY + 1\r\n    default:\r\n      return this.headY\r\n  }\r\n}\r\n\r\nthis.nextHeadX = () => {\r\n  switch(this.direction) {\r\n    case 'l':\r\n      return this.headX - 1\r\n    case 'r':\r\n      return this.headX + 1\r\n    default:\r\n      return this.headX\r\n  }\r\n}\r\n\r\nthis.moveSnake = () => {\r\n  const nextHeadY = this.nextHeadY()\r\n  const nextHeadX = this.nextHeadX()\r\n\r\n  if (nextHeadX < 0 || nextHeadX >= this.width || nextHeadY < 0 || nextHeadY >= this.height) {\r\n    return this.endGame()\r\n  }\r\n\r\n  this.headY = nextHeadY\r\n  this.headX = nextHeadX\r\n\r\n  this.field[nextHeadY][nextHeadX] = 1\r\n}\r\n\r\nthis.onMouseDown = event => {\r\n  switch (event.target.textContent) {\r\n    case '2':\r\n      return this.onNewDirection('u')\r\n    case '6':\r\n      return this.onNewDirection('r')\r\n    case '8':\r\n      return this.onNewDirection('d')\r\n    case '4':\r\n      return this.onNewDirection('l')\r\n  }\r\n}\r\n\r\nthis.onKeyDown = event => {\r\n  switch (event.code) {\r\n    case 'ArrowUp':\r\n    case 'KeyW':\r\n      return this.onNewDirection('u')\r\n    case 'ArrowRight':\r\n    case 'KeyD':\r\n      return this.onNewDirection('r')\r\n    case 'ArrowDown':\r\n    case 'KeyS':\r\n      return this.onNewDirection('d')\r\n    case 'ArrowLeft':\r\n    case 'KeyA':\r\n      return this.onNewDirection('l')\r\n  }\r\n}\r\n\r\nthis.onNewDirection = newDirection => {\r\n  switch (newDirection) {\r\n    case 'u':\r\n      if (this.direction !== 'd') this.setDirection('u')\r\n      break\r\n    case 'r':\r\n      if (this.direction !== 'l') this.setDirection('r')\r\n      break\r\n    case 'd':\r\n      if (this.direction !== 'u') this.setDirection('d')\r\n      break\r\n    case 'l':\r\n      if (this.direction !== 'r') this.setDirection('l')\r\n      break\r\n  }\r\n}\r\n\r\nthis.setDirection = newDirection => {\r\n  // TODO: Buffer direction updates\r\n  if (this.directionUpdatedThisTick) return\r\n\r\n  this.directionUpdatedThisTick = true\r\n  this.direction = newDirection\r\n}\r\n\r\nthis.onTick = () => {\r\n  this.directionUpdatedThisTick = false\r\n  if (this.nextDirectionCandidate) {\r\n    this.direction = this.nextDirectionCandidate\r\n    this.nextDirectionCandidate = null\r\n  }\r\n  if (!this.gameOver) this.moveSnake()\r\n  this.draw()\r\n}\r\n\r\nthis.endGame = () => {\r\n  this.gameOver = true\r\n  // alert('Game over')\r\n  console.log('Game over')\r\n}\r\n\r\nthis.draw = () => {\r\n  const containerElement = document.querySelector('.snake')\r\n  containerElement.textContent = ''\r\n\r\n  this.field.forEach(row => {\r\n    const rowElement = document.createElement('div')\r\n    rowElement.className = 'row'\r\n\r\n    row.forEach(cell => {\r\n      const cellElement = document.createElement('div')\r\n      cellElement.className = `cell ${cell ? 'snake' : ''}`\r\n\r\n      rowElement.appendChild(cellElement)\r\n    })\r\n\r\n    containerElement.appendChild(rowElement)\r\n  })\r\n}\r\n\r\nwindow.addEventListener('DOMContentLoaded', _event => {\r\n  this.draw()\r\n  document.querySelector('.keyboard').addEventListener('mousedown', this.onMouseDown)\r\n  document.addEventListener('keydown', this.onKeyDown)\r\n  setInterval(this.onTick, 200)\r\n})"]}